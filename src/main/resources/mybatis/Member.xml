<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Member">
	<!-- JSY -->
	<resultMap id="AlarmListProcedure" type="AlarmList">
		<result property="alarm_sq" column="alarm_sq"/>
		<result property="alarm_type" column="alarm_type"/>
		<result property="status" column="status"/>
		<result property="nick" column="nick"/>
		<result property="reply_level" column="reply_level"/>
		<result property="album_nm" column="album_nm"/>
		<result property="music_nm" column="music_nm"/>
	</resultMap>
	
	<insert id="insertAlarmShareMusic" parameterType="hashmap">
		insert into alarm values(alarm_sq.nextval,#{id},#{music_sq},'음악','N')
	</insert>
	<select id="selectAlarmMemberList" parameterType="java.util.Map" statementType="CALLABLE">
			{call selectAlarmMemberList(
										#{member_sq,	mode=IN,	jdbcType=INTEGER},
										#{alarmList,	mode=OUT,	jdbcType=CURSOR,
										  javaType=java.sql.ResultSet,
										  resultMap=AlarmListProcedure})
			}
	</select> 
	
	
	<!-- PHmaruho -->
	<select id="selectMemberArtist" parameterType="java.lang.String" resultType="Member">
		SELECT member_sq, nick, email
		FROM member
		WHERE email like '%' || #{keyword} || '%'
		   OR nick  like '%' || #{keyword} || '%'
		ORDER BY nick desc, email desc
	</select>
	<select id="login" parameterType="Member" resultType="int">
		select count(*) from member where email=#{email} and pw=#{pw}
	</select>
	
	<select id="loginRest" parameterType="Member" resultType="Member">
		select * from member where email=#{email} and pw=#{pw}
	</select>
	
	<select id="emailCheck" parameterType="Member" resultType="int">
		select count(*) from member where email=#{email}
	</select>
	
	<select id="join" parameterType="Member">
		insert into member values(
  					(
  					 select nvl(max(member_sq),0)+1 
  					 from member
  					 )
  					 ,#{email},#{pw},#{nick},'A0',sysdate,sysdate
		)
	</select>
</mapper>
